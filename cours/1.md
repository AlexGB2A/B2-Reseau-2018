# B2 Réseau - Cours 1

Première séance : remise dans le bain. Tranquilou.

* Sommaire

## Un peu de théorie autour de IP

[IP](./lexique.md#ip--internet-protocol-v4) : 
* utilise la [base 2, ou "binaire"](./lexique.md#binaire)
* une adresse IP est composée de 4 octets
* les valeurs sont donc comprises entre 0 et 255
* **une adresse IP seule n'a pas de sens : on a besoin du *masque de sous-réseau***
* le masque s'écrit **toujours** comme une suite de 1 **puis** une suite de 0 en binaire
  * un masque courant est `255.255.255.0` il s'écrit `11111111.11111111.11111111.00000000` en binaire
  * on peut aussi utiliser la *notation CIDR* et indiquer le nombre de bits ayant la valeur 1, après l'IP
  * par exemple, **le masque `255.255.255.0` se note `/24` en *notation CIDR***
* une adresse IP est composée de deux informations : *l'adresse de réseau* et *l'adresse d'hôte*, il faut le masque pour les déterminer

Comme (re)vu en cours, il est nécessaire de redescendre au binaire pour comprendre ce qu'est une adresse IP, un masque, afin de pouvoir en déduire des informations comme [l'adresse de réseau](./lexique.md#adresse-de-réseau). Je vous renvois directement vers [le cours des B1 de cette année à ce sujet](https://github.com/It4lik/B1-Reseau-2018/blob/master/cours/1.md#2-manipulations-dadresses-ip) si vous galérez à manipuler binaire & IP. 

## Exploration du réseau de votre machine hôte

Quand on parle du "réseau" d'une machine, on parle de la [stack réseau](./lexique.md#stack-réseau-ou-stack-tcpip-ou-pile-réseau) de cette machine. **C'est juste un gros mot pour désigner tout ce qui touche de près ou de loin au réseau dans votre machine m'kay ?**  

"Être dans un réseau", ça signifie 3 choses : 
* avoir une [interface réseau](./lexique.md#carte-réseau-ou-interface-réseau)
* relier cet interface à une ou plusieurs autres machines
  * avec un câble
  * par WiFi
  * autres (qui a dit 4G ?)
* avoir une adresse IP dans ce réseau

### Cartes réseau

Pour obtenir une liste des [cartes réseau](./lexique.md#carte-réseau-ou-interface-réseau) de la machine, on utilise un [`ipconfig` (ou autres suivant l'OS)](./lexique.md#ipconfig-ou-ifconfig-ou-ip-a). On y trouve, entre autres, les informations suivantes : 
* présence de [l'interface de loopback](./lexique.md#loopback)
* noms des carte réseau
* [adresse MAC](./lexique.md#mac--media-access-control) de chaque carte réseau
* [adresse IP](./lexique.md#ip--internet-protocol-v4) et [masque de sous-réseau](/lexique.md#masque-de-sous-réseau) de chaque carte réseau
* suivant l'OS : [l'adresse de passerelle](./lexique.md#passerelle-ou-gateway) et [l'adresse de broadcast](./lexique.md#adresse-de-diffusion-ou-broadcast-address)

A partir de ces informations, vous devez être capable de déterminer : 
* [l'adresse de réseau](./lexique.md#adresse-de-réseau) pour chacune des interfaces réseau
* [l'adresse de broadcast](./lexique.md#adresse-de-diffusion-ou-broadcast-address) pour chacun de ces réseaux

### Table de routage

C'est un tableau qui contient la liste des réseaux où votre machine sait aller. On y trouve :
* tous les réseaux auquels vous êtes directement connectés
  * "en partant de chez moi, c'est vers où ma rue ?" ==> c'est devant chez toi
* très souvent une "route par défaut"
  * c'est le panneau "Toutes directions"
  * permet d'aller dans n'importe quel autre réseau que ceux listés dans la table de routage  

**Une "route" c'est juste un panneau pour indiquer comment aller dans un réseau donné**. Une route est composée de :
* le réseau à joindre
* l'interface réseau à utiliser pour y aller
* la machine qui sert de ["passerelle"](./lexique.md#passerelle-ou-gateway) pour y aller
  * les routes pour des réseaux où vous êtes directement connectés ne possèdent pas de gateway
  * en effet, vous y êtes déjà connectés, donc inutile de passer par une machine intermédiaire !

Pour afficher la table de routage : 
* Windows : `route print -4`
  * le `-4` c'est pour avoir que l'IPv4
* MacOS : `netstat -nr`
* GNU/Linux : `ip route show`

### Table de voisinnage (ou table ARP)
On reviendra sur le fonctionnement de ARP très très bientôt.  

A retenir pour ce cours : la table ARP contient la liste de nos voisins connus. Un "voisin", c'est "quelqu'un" sur le même réseau que nous. "Quelqu'un" c'est une [adresse MAC](./lexique.md#mac--media-access-control). Quelqu'un de "connu" c'est quelqu'un qu'on a déjà contacté auparavant.

**Donc votre table ARP contient une liste de toutes les machines qui sont sur le même réseau que vous et avec qui vous avez déjà discuté auparavant.**  

Plus spécifiquement, **la table ARP stocke une association entre des adresses IP et des adresses MAC** : 
* pour discuter avec quelqu'un qui est sur le même réseau que nous, on peut utiliser uniquement sa MAC
* mais généralement on utilise IP quand même (genre `ping <IP_DE_TOI_LA_BAS>`)
* donc on a besoin de connaître la MAC des gens sur notre réseau
  * si on veut discuter avec eux, inutile de flooder non plus

Il y a une machine sur votre réseau avec qui vous avez (très très probablement) déjà discuté : votre [passerelle](./lexique.md#passerelle-ou-gateway).  

Pour afficher la table ARP : 
* Windows : `arp -a`
* MacOS : `arp -a`
* GNU/Linux : `ip neigh show`
  * "neigh" c'est pour "neighbor" ça veut dire.... "voisin"
## Installation et configuration d'une VM CentOS 7

## Exploration du réseau d'une VM CentOS 7

